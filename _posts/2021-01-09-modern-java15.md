---
title: 모던 자바 인 액션 - 19장 함수형 프로그래밍 기법
description: 모던 자바 인 액션 - 19장 함수형 프로그래밍 기법
categories:
 - dev
tags:
 - java
comments: true
---
> Modern Java In Action 정리 - 함수형 프로그래밍 기법

  * 일급 시민, 고차원함수, 커링, 부분 적용
  * 영속 자료구조
  * 자바 스트림을 일반화하는 게으른 평가와 게으른 리스트
  * 패턴 매칭, 자바에서 패턴 매칭을 흉내 내는 방법
  * 참조 투명성과 캐싱

`모던 자바 인 액션 책을 보고 정리한 글입니다.` 

## 함수는 모든 곳에 존재한다.
* 함수형 프로그래밍이란 함수나 메서드가 수학의 함수처럼 동작함을, 즉 부작용 없이 동작함을 의미했다. 
* 함수형 프래그래밍에서는 함수를 마치 일반값처럼 사용해서 인수로 전달하거나, 결과로 반환받거나, 자료구조에 저장할 수 있음을 의미한다. 
* 일반값처럼 취급할 수 있는 함수를 일급함수라고 한다.
  
### 고차원 함수
* 지금까지 함숫값을 스트림의 처리연산으로 전달하거나, 메서드 참조를 활용하여 전달하는 등 동작 파라미터화를 달성하는 용도로만 사용해봤다. 이는 함수값 뢀용의 일부에 불과하다.
* 함수를 인수로 받아 새로운 함수를 만드는 정적 메서드 Comparator.comparing 을 생각해보자.

```java
Comparator<Apple> c = comparing(Apple::getWeight);

// 함수를 조립하여 연산 파이프라인을 만들 때 사용.
Function<String, String> transformationPipeline = addHeader.andThen(Letter::checkSplelling)
                                                           .andThen(Letter::addFooter);
```

* Comparator.comparing 처럼 다음 중 하나 이상의 동작을 수행하는 함수를 고차원 함수라 부른다.
  * 하나 이상의 함수를 인수로 받음
  * 함수를 결과로 반환

### 커링
* 함수를 모듈화 하고 코드를 재사용하는데 도움을 주는 **커링**을 살펴보자.
* 변환요소와 기준치 조정 요소가 단위 변환 결과를 좌우하는데 섭씨를 화씨로 변환하는 예제를 가지고 커링에 대해 살펴보자. 
* ```CtoF(x) = x * 9/5 + 32```
  1. 변환 요소를 곱함
  2. 기준치 조정 요소를 적용
* 다음과 같이 메서드로 변환 패턴을 표현 할 수 있다.

```java
static double converter(double x, double f, double b) {
  return x * f + b;
}
```

* 여기서 x는 변환하려는 값이고, f는 변환 요소, b는 기준치 조정 요소이다. 온도뿐아니라 키로미터와 마일 등의 단위도 변환 해야 할 것이다. 
* 세 개의 인수를 받는 converter를 매번 만들어 해결하는 방법도 있지만, 함수를 활용하여 로직을 재활용 해보자. 
* 기존 로직을 활용하여 변환기를 특정 상황에 적용할 수 있는 방법이 있다. 다름은 커링이라는 개념을 활용하여 한 개의 인수를 갖는 변환 함수를 생산하는 팩토리를 정의하는 코드이다. 

```java
static DoubleUnaryOperator curriedConverter(double f, double b) {
  return (Double x) -> x * f + b;
}
```

* 위 메서드에 변환요소와 기준치만 넘겨주면 원하는 작업을 수행할 함수가 반환된다. 

```java
DoubleUnaryOperator convertCtoF = curriedConverter(9.0/5, 32);
DoubleUnaryOperator convertUSDtoGBP = curriedConverter(0.6, 0);
DoubleUnaryOperator convertKmtoMi = curriedConverter(0.6214, 0);

convertUSDtoGBP.applyAdDouble(1000);
```

* 결과적으로 기존의 변환 로직을 재활용하는 유연한 코드를 얻었다. 
* 커링은 x와 y라는 두 인수를 받는 함수 f를 한 개의 인수를 받는 g라는 함수로 대체하는 기법이다.

